# 一、作用域

一段程序中所用到的名字并不总是有效和可用的，而限定这个名字的*可用性的代码范围*就是这个名字的**作用域**。作用域的使用提高了程序的逻辑性，增强了程序的可靠性，也减少了名字冲突。

es5 的作用域分为全局作用域和局部作用域。

* 全局作用域的范围是整个页面(可以跨 script 标签和 js 文件)。

  ```html
  <script>
      var num = 3;
  </script>
  <script>
  	console.log(num);	//3
  	console.log(b);		//引入的 js 文件中的变量，也可以使用
  </script>
  ```

* 局部作用域也叫函数作用域，只在函数内部有效。

  ```javascript
  function fn() {
  	var i = 6;
  	console.log(i);
  }
  fn(); 		    // 6
  console.log(i);	//i is not defined
  ```

* es5及以前没有块级作用域的概念。es6 才出现块级作用域，在 es6 中或其它语言中，用 {} 包裹起来的范围就块级作用域。

# 二、变量的作用域

在 js 中，可以根据作用域的不同，将变量分为两种：

* 全局变量
* 局部变量

## 1. 全局变量

在全局作用域(函数外部)下声明的变量叫做全局变量。

* 全局变量在整个页面都可以使用
* 在全局作用域下使用 var 声明的就是全局变量
* 特殊情况，函数内部没有使用 var 声明的变量也是全局变量(个人觉得属于一个bug，不建议使用)

```javascript
var x = 1;
function fun() {
  y = 0;	//特殊情况定义的全局变量
}
fun();
console.log(x);	// 1
console.log(y);	// 0
```

## 2. 局部变量

在局部作用域下(函数内部)声明的变量就是局部变量。

* 局部变量只能在函数内部使用
* 在函数内部使用 var 声明的变量就是局部变量
* 函数的形参也是局部变量

```javascript
function fun(num1, num2) {
  var sum = 0;
  sum = num1 + num2;
  console.log(sum);
}
fun(3, 5);		    // 8
console.log(num1);	// num1 is not defined
```

## 3. 全局变量与局部变量的区别

* 全局变量：在整个页面都可以使用，只有页面关闭时才会被销毁，所以比较占内存
* 局部变量：只在函数内部起作用，函数执行时被初始化，函数执行结束后销毁，所以比较省内存

# 三、作用域链

* 只要是变量，就存在着一个作用域
* 一个函数内部一个局部作用域
* 如果函数中还有函数，那么又可以诞生一个新的作用域。
* 在确定变量的值时，js 是从函数内部往外用链式方式逐级查找，这就是 js 的作用域链



